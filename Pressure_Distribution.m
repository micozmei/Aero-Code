%% PROBLEM 3
clearvars; clc
alpha = 4.81*pi/180;
xU = [0 0.015 0.03 0.05 0.07 0.09 0.12 0.15 0.18 0.22 0.26 0.3 0.4 0.5 0.6 0.7 0.8 0.9 0.96]';
xL = [0 0.03 0.05 0.07 0.09 0.12 0.22 0.4 0.6 0.8 0.96]';
zU = [0 0.00006604 0.002826174 0.004013201 0.005139268 0.006087535 0.006829215 0.007794416 0.008647856 0.00937599 0.01022943 0.010967723 0.011557004 0.012696617 0.013208004 0.013119951 0.012354564 0.010720497 0.008539483]';
zL = [0 0.0062 0.0032 -0.0031 -0.0064 -0.0065 -0.0054 -0.0049 -0.0044 -0.0038 -0.0031]';
CpU = [-0.4367 -1.2939 -1.0637 -0.904 -0.8054 -0.7177 -0.6291 -0.5732 -0.5501 -0.5256 -0.5081 -0.4905 -0.4628 -0.4329 -0.408 -0.3646 -0.2661 -0.1794 -0.1153]';
CpL = [-0.4367 0.375 0.2956 0.2336 0.189 0.1358 0.03680 -0.0378 -0.0116 0.1871 0.3007]';
Cn = trapz(xL,CpL)-trapz(xU,CpU);
Ca = trapz(zU,CpU)-trapz(zL,CpL);
Cl = Cn*cos(alpha)-Ca*sin(alpha);
Cd = Cn*sin(alpha)+Ca*cos(alpha);
Cmle = trapz(xU,CpU.*xU)-trapz(xL,CpL.*xL)+trapz(zU,CpU.*zU)-trapz(zL,CpL.*zL);

%% PROBLEM 4
clearvars; clc
c = 0.127; % chord length [m]
xU = [0 0 0.44 0.94 1.7 2.94 4.9 7.5 9.96 12.58 14.92 17.44 19.96 22.44 24.92 27.44 29.88 34.95 39.9 44.8 49.92 54.92 59.94 64.90 69.86 74.90 79.92 84.88 89.88 94.9 98]'*c/100;
xL = [0 0.36 0.92 1.66 2.92 4.94 7.38 9.96 14.94 19.98]'*c/100;
zU = [0 0.68 1.56 2.16 2.78 3.64 4.68 5.74 6.56 7.34 7.88 8.4 8.8 9.16 9.52 9.62 9.76 9.9 9.84 9.64 9.22 8.76 8.16 7.54 6.76 5.88 4.92 3.88 2.74 1.48 0.68]'*c/100;
zL = [0 -0.7 -1.2 -1.6 -2.06 -2.46 -2.72 -2.86 -2.9 -2.76]'*c/100;
alpha = [-4 2 16]*pi/180;

CpU = [-0.296 0.681 0.994 0.939 0.782 0.559 0.333 0.139 0.017 -0.091 -0.152 -0.21 -0.262 -0.322 -0.322 -0.355 -0.364 -0.381 -0.370 -0.371 -0.329 -0.303 -0.298 -0.264 -0.225 -0.183 -0.144 -0.091 -0.019 0.069 0.139;
0.989 0.854 0.336 0.055 -0.148 -0.336 -0.485 -0.568 -0.623 -0.676 -0.7 -0.721 -0.74 -0.769 -0.746 -0.742 -0.722 -0.693 -0.635 -0.609 -0.525 -0.471 -0.438 -0.378 -0.319 -0.252 -0.191 -0.116 -0.026 -0.076 -0.143; 
-3.648 -6.23 -5.961 -5.21 -4.478 -3.765 -3.19 -2.709 -2.44 -2.24 -2.149 -1.952 -1.841 -1.758 -1.640 -1.535 -1.438 -1.269 -1.099 -0.961 -0.786 -0.649 -0.551 -0.414 -0.316 -0.212 -0.147 -0.082 -0.043 -0.016 -0.004]';

CpL = [-0.296 -1.559 -1.812 -1.709 -1.38 -1.106 -0.867 -0.716 -0.502 -0.365;
0.989 0.639 0.254 0.028 -0.098 -0.15 -0.131 -0.111 -0.053 -0.011; 
-3.648 -1.379 0.264 0.791 0.993 0.98 0.896 0.818 0.713 0.627]';

Cn = zeros(3,1);
Ca = zeros(3,1);
Cl = zeros(3,1);
Cd = zeros(3,1);
Cmle = zeros(3,1);

for i = 1:3
Cn(i) = 1/c*(trapz(xL,CpL(:,i))-trapz(xU,CpU(:,i)));
Ca(i) = 1/c*(trapz(zU,CpU(:,i))-trapz(zL,CpL(:,i)));
Cl(i) = Cn(i)*cos(alpha(i))-Ca(i)*sin(alpha(i));
Cd(i) = Cn(i)*sin(alpha(i))+Ca(i)*cos(alpha(i));
Cmle(i) = 1/(c^2)*(trapz(xU,CpU(:,i).*xU)-trapz(xL,CpL(:,i).*xL)...
+trapz(zU,CpU(:,i).*zU)-trapz(zL,CpL(:,i).*zL));
end

hold on
box on
grid minor
set(gca,'Ydir','reverse')
set(gca,'FontSize',12)
xlim([0 1])
plot(xU/c,CpU(:,1),'k','LineWidth',1)
plot(xL/c,CpL(:,1),'k--','LineWidth',1)
plot(xU/c,CpU(:,2),'b','LineWidth',1)
plot(xL/c,CpL(:,2),'b--','LineWidth',1)
plot(xU/c,CpU(:,3),'r','LineWidth',1)
plot(xL/c,CpL(:,3),'r--','LineWidth',1)
xlabel('Fraction of Chord Length [x/c]')
ylabel('Pressure Coefficient, C_p')
legend('\alpha = -4 deg, C_{p,u}','\alpha = -4 deg, C_{p,l}',...
'\alpha = 2 deg, C_{p,u}','\alpha = 2 deg, C_{p,l}',...
'\alpha = 16 deg, C_{p,u}','\alpha = 16 deg, C_{p,l}')
title('Pressure Distribution as f(\alpha)')